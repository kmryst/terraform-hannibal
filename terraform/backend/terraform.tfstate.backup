{
  "version": 4,
  "terraform_version": "1.11.2",
  "serial": 81,
  "lineage": "c0083cb1-da62-e7dd-2f1f-dc1b49e4a10f",
  "outputs": {
    "ecr_repository_url": {
      "value": "258632448142.dkr.ecr.ap-northeast-1.amazonaws.com/nestjs-hannibal-3",
      "type": "string"
    },
    "ecs_cluster_name": {
      "value": "nestjs-hannibal-3-cluster",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "aws_subnets",
      "name": "public",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filter": [
              {
                "name": "vpc-id",
                "values": [
                  "vpc-0ee3f7a7b539cb9b8"
                ]
              }
            ],
            "id": "ap-northeast-1",
            "ids": [
              "subnet-094fb627640013bb3",
              "subnet-07acf878cc4f1e84c",
              "subnet-074caf32ce48abb25"
            ],
            "tags": null,
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "aws_vpc",
      "name": "selected",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ec2:ap-northeast-1:258632448142:vpc/vpc-0ee3f7a7b539cb9b8",
            "cidr_block": "172.31.0.0/16",
            "cidr_block_associations": [
              {
                "association_id": "vpc-cidr-assoc-01484c8f9b0559dd0",
                "cidr_block": "172.31.0.0/16",
                "state": "associated"
              }
            ],
            "default": true,
            "dhcp_options_id": "dopt-0fb18a71980f8ed0e",
            "enable_dns_hostnames": true,
            "enable_dns_support": true,
            "enable_network_address_usage_metrics": false,
            "filter": null,
            "id": "vpc-0ee3f7a7b539cb9b8",
            "instance_tenancy": "default",
            "ipv6_association_id": "",
            "ipv6_cidr_block": "",
            "main_route_table_id": "rtb-07ec000d2abfc0df5",
            "owner_id": "258632448142",
            "state": null,
            "tags": {},
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_ecr_lifecycle_policy",
      "name": "nestjs_hannibal_3_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "nestjs-hannibal-3",
            "policy": "{\"rules\":[{\"action\":{\"type\":\"expire\"},\"description\":\"Keep last 10 images\",\"rulePriority\":1,\"selection\":{\"countNumber\":10,\"countType\":\"imageCountMoreThan\",\"tagStatus\":\"any\"}}]}",
            "registry_id": "258632448142",
            "repository": "nestjs-hannibal-3"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_ecs_cluster",
      "name": "main",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ecs:ap-northeast-1:258632448142:cluster/nestjs-hannibal-3-cluster",
            "configuration": [],
            "id": "arn:aws:ecs:ap-northeast-1:258632448142:cluster/nestjs-hannibal-3-cluster",
            "name": "nestjs-hannibal-3-cluster",
            "service_connect_defaults": [],
            "setting": [
              {
                "name": "containerInsights",
                "value": "disabled"
              }
            ],
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "hannibal_terraform_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::258632448142:policy/HannibalInfraAdminPolicy",
            "attachment_count": 1,
            "description": "Custom policy for Terraform ECS deployment - ECR, CloudWatch, ELB, EC2, ECS, IAM, S3, CloudFront permissions",
            "id": "arn:aws:iam::258632448142:policy/HannibalInfraAdminPolicy",
            "name": "HannibalInfraAdminPolicy",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"ecr:GetAuthorizationToken\",\"ecr:BatchCheckLayerAvailability\",\"ecr:GetDownloadUrlForLayer\",\"ecr:BatchGetImage\",\"ecr:DescribeRepositories\",\"ecr:ListImages\",\"ecr:DescribeImages\",\"ecr:BatchDeleteImage\",\"ecr:GetLifecyclePolicy\",\"ecr:PutLifecyclePolicy\",\"ecr:DeleteLifecyclePolicy\",\"ecr:ListTagsForResource\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:ecr:ap-northeast-1:258632448142:repository/nestjs-hannibal-3\"},{\"Action\":[\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:PutLogEvents\",\"logs:DescribeLogGroups\",\"logs:DescribeLogStreams\",\"logs:PutRetentionPolicy\",\"logs:DeleteLogGroup\",\"logs:ListTagsForResource\"],\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"elasticloadbalancing:CreateLoadBalancer\",\"elasticloadbalancing:CreateTargetGroup\",\"elasticloadbalancing:CreateListener\",\"elasticloadbalancing:DescribeLoadBalancers\",\"elasticloadbalancing:DescribeTargetGroups\",\"elasticloadbalancing:DescribeListeners\",\"elasticloadbalancing:ModifyLoadBalancerAttributes\",\"elasticloadbalancing:ModifyTargetGroupAttributes\",\"elasticloadbalancing:DeleteLoadBalancer\",\"elasticloadbalancing:DeleteTargetGroup\",\"elasticloadbalancing:DeleteListener\",\"elasticloadbalancing:AddTags\",\"elasticloadbalancing:RemoveTags\",\"elbv2:DescribeLoadBalancers\",\"elbv2:DeleteLoadBalancer\",\"elbv2:DescribeTargetGroups\",\"elbv2:DeleteTargetGroup\",\"elasticloadbalancing:DescribeLoadBalancerAttributes\",\"elasticloadbalancing:DescribeTargetGroupAttributes\",\"elasticloadbalancing:DescribeTags\",\"elasticloadbalancing:DescribeListenerAttributes\"],\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"ec2:DescribeVpcs\",\"ec2:DescribeSubnets\",\"ec2:DescribeSecurityGroups\",\"ec2:DescribeNetworkInterfaces\",\"ec2:CreateNetworkInterface\",\"ec2:DeleteNetworkInterface\",\"ec2:DescribeRouteTables\",\"ec2:DescribeInternetGateways\",\"ec2:DescribeAddresses\",\"ec2:AssociateAddress\",\"ec2:DisassociateAddress\",\"ec2:DescribeVpcAttribute\",\"ec2:CreateSecurityGroup\",\"ec2:DeleteSecurityGroup\",\"ec2:AuthorizeSecurityGroupIngress\",\"ec2:AuthorizeSecurityGroupEgress\",\"ec2:RevokeSecurityGroupIngress\",\"ec2:RevokeSecurityGroupEgress\",\"ec2:CreateTags\"],\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"ecs:DescribeClusters\",\"ecs:ListClusters\",\"ecs:DescribeServices\",\"ecs:ListServices\",\"ecs:RegisterTaskDefinition\",\"ecs:DeregisterTaskDefinition\",\"ecs:DescribeTaskDefinition\",\"ecs:ListTaskDefinitions\",\"ecs:CreateService\",\"ecs:UpdateService\",\"ecs:DeleteService\",\"ecs:DescribeTasks\",\"ecs:ListTasks\",\"ecs:RunTask\",\"ecs:StopTask\",\"ecs:DeleteCluster\",\"ecs:CreateCluster\"],\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"iam:CreateRole\",\"iam:AttachRolePolicy\",\"iam:DetachRolePolicy\",\"iam:DeleteRole\",\"iam:GetRole\",\"iam:ListAttachedRolePolicies\",\"iam:PassRole\",\"iam:CreatePolicy\",\"iam:DeletePolicy\",\"iam:GetPolicy\",\"iam:GetPolicyVersion\",\"iam:AttachUserPolicy\",\"iam:DetachUserPolicy\",\"iam:ListUserPolicies\",\"iam:ListAttachedUserPolicies\",\"iam:GetUser\",\"iam:ListPolicyVersions\",\"iam:CreatePolicyVersion\",\"iam:DeletePolicyVersion\"],\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":[\"s3:CreateBucket\",\"s3:DeleteBucket\",\"s3:ListBucket\",\"s3:GetBucketLocation\",\"s3:GetObject\",\"s3:PutObject\",\"s3:DeleteObject\",\"s3:PutBucketPolicy\",\"s3:GetBucketPolicy\",\"s3:PutBucketPublicAccessBlock\",\"s3:GetBucketPublicAccessBlock\",\"s3:GetObjectTagging\",\"s3:PutObjectTagging\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3:::*\",\"arn:aws:s3:::*/*\"]},{\"Action\":[\"cloudfront:CreateDistribution\",\"cloudfront:UpdateDistribution\",\"cloudfront:GetDistribution\",\"cloudfront:CreateInvalidation\",\"cloudfront:GetInvalidation\",\"cloudfront:ListDistributions\",\"cloudfront:ListOriginAccessControls\",\"cloudfront:CreateOriginAccessControl\",\"cloudfront:GetOriginAccessControl\",\"cloudfront:UpdateOriginAccessControl\",\"cloudfront:DeleteOriginAccessControl\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPATYN5R7CHNPF3WWA6J",
            "tags": {},
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_user_policy_attachment",
      "name": "hannibal_terraform_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "hannibal-20250628080732493400000001",
            "policy_arn": "arn:aws:iam::258632448142:policy/HannibalInfraAdminPolicy",
            "user": "hannibal"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_policy.hannibal_terraform_policy"
          ]
        }
      ]
    }
  ],
  "check_results": null
}

# ãƒãƒ³ãƒ‹ãƒãƒ«ã®ã‚¢ãƒ«ãƒ—ã‚¹è¶Šãˆãƒ«ãƒ¼ãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

<div align="center">
  
![AWS](https://img.shields.io/badge/AWS-Route53%20%7C%20CloudFront%20%7C%20ALB%20%7C%20ECS%20%7C%20RDS%20%7C%20S3-orange?logo=amazon-aws)
![Terraform](https://img.shields.io/badge/Terraform-1.12.1-purple?logo=terraform)
![Docker](https://img.shields.io/badge/Docker-node:20--alpine-blue?logo=docker)
![GitHub Actions](https://img.shields.io/badge/GitHub%20Actions-CI%2FCD-2088FF?logo=github-actions)
![TypeScript](https://img.shields.io/badge/TypeScript-5.8-blue?logo=typescript)
![NestJS](https://img.shields.io/badge/NestJS-10.0-red?logo=nestjs)
![React](https://img.shields.io/badge/React-19.0-blue?logo=react)

</div>

<div align="center">
  <img src="docs/screenshots/hannibal-route.png" alt="ãƒãƒ³ãƒ‹ãƒãƒ«ã®ã‚¢ãƒ«ãƒ—ã‚¹è¶Šãˆãƒ«ãƒ¼ãƒˆ" width="800">
</div>

<div align="center">
  <img src="docs/screenshots/hannibal_1_middle.gif" alt="ãƒãƒ³ãƒ‹ãƒãƒ«ãƒ‡ãƒ¢" width="800">
</div>

<br>

## ğŸ’¡ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

æ­´å²çš„ãƒ«ãƒ¼ãƒˆã‚’å¯è¦–åŒ–ã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é¡Œæã«ã€**å®Ÿå‹™ã§ä½¿ã‚ã‚Œã‚‹AWSã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆã§æ§‹ç¯‰**ã€‚

**è¨­è¨ˆæ–¹é‡**: 
- æœ¬ç•ªç’°å¢ƒã‚’æƒ³å®šã—ãŸã‚»ã‚­ãƒ¥ã‚¢ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­è¨ˆï¼ˆ3å±¤VPCï¼‰
- ã‚³ã‚¹ãƒˆåŠ¹ç‡ã‚’é‡è¦–ã—ãŸé©åˆ‡ãªã‚µãƒ¼ãƒ“ã‚¹é¸å®šï¼ˆFargate 0.25vCPUï¼‰
- å®Œå…¨è‡ªå‹•åŒ–ã•ã‚ŒãŸCI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆBlue/Green + Canaryå¯¾å¿œï¼‰

**å€‹äººé–‹ç™º**: ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ãƒ¼ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¾ã§ã™ã¹ã¦ä¸€äººã§è¨­è¨ˆã€é–‹ç™ºã€é‹ç”¨ã€‚

<br>

## ğŸŒ ãƒ‡ãƒ¢ã‚µã‚¤ãƒˆ

[hamilcar-hannibal.click](https://hamilcar-hannibal.click) ã§ãƒ©ã‚¤ãƒ–ãƒ‡ãƒ¢ã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™ã€‚

**ã‚³ã‚¹ãƒˆæœ€é©åŒ–é‹ç”¨ä¸­** - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆECSã€RDSã€ALBç­‰ï¼‰ã‚’åœæ­¢ã™ã‚‹ã“ã¨ã§ã€æœˆé¡ã‚³ã‚¹ãƒˆã‚’ç´„$30-50ã‹ã‚‰**ç´„$5ä»¥ä¸‹**ã«å‰Šæ¸›ã€‚  
GitHub Actionsã§**ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯èµ·å‹•/åœæ­¢**ãŒå¯èƒ½ï¼ˆç´„15åˆ†ã§ãƒ•ãƒ«ç¨¼åƒï¼‰ã€‚  
ãƒ‡ãƒ¢ã”å¸Œæœ›ã®éš›ã¯ãŠæ°—è»½ã«ãŠå£°ãŒã‘ãã ã•ã„ğŸ˜Š

â€»åŸºç›¤ãƒªã‚½ãƒ¼ã‚¹ï¼ˆS3 Stateç®¡ç†ã€CloudTrailç­‰ï¼‰ã¯å¸¸æ™‚ç¨¼åƒ

<br>

## AWS Architecture Diagram

<div align="center">
  <img src="docs/architecture/aws/cacoo/architecture.svg" alt="AWS Architecture Diagram" width="800">
</div>

<br>

## ğŸ—ï¸ Infrastructure as Code

### ã‚¤ãƒ³ãƒ•ãƒ©è¦æ¨¡
- **Terraformãƒªã‚½ãƒ¼ã‚¹æ•°**: ç´„50ãƒªã‚½ãƒ¼ã‚¹
- **æœˆé¡ã‚³ã‚¹ãƒˆ**: ç´„$30-50ï¼ˆåœæ­¢æ™‚: $0ï¼‰
- **ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚é–“**: ç´„15åˆ†ï¼ˆBlue/Greenåˆ‡æ›¿: 5åˆ†ï¼‰
- **ã‚³ãƒ¼ãƒ‰è¡Œæ•°**: Backend 5,000è¡Œ / Frontend 3,000è¡Œ / Terraform 2,000è¡Œ

### Terraform æ§‹æˆ
```
terraform/
â”œâ”€â”€ foundation/          # åŸºç›¤ãƒªã‚½ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ iam.tf          # Permission Boundary + AssumeRole
â”‚   â”œâ”€â”€ athena.tf       # CloudTrailåˆ†æ
â”‚   â”œâ”€â”€ billing.tf      # ã‚³ã‚¹ãƒˆç›£è¦–
â”‚   â””â”€â”€ guardduty.tf    # è„…å¨æ¤œçŸ¥ï¼ˆã‚³ã‚¹ãƒˆå‰Šæ¸›ã®ãŸã‚ç„¡åŠ¹åŒ–ä¸­ï¼‰
â”œâ”€â”€ environments/dev/    # ç’°å¢ƒåˆ¥è¨­å®š
â”‚   â””â”€â”€ main.tf         # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«çµ±åˆ
â””â”€â”€ modules/            # å†åˆ©ç”¨å¯èƒ½ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
    â”œâ”€â”€ cdn/            # CloudFront
    â”œâ”€â”€ cicd/           # CodeDeploy Blue/Green
    â”œâ”€â”€ compute/        # ECS Fargate + ALB
    â”œâ”€â”€ networking/     # 3å±¤VPCï¼ˆPublic/App/Dataï¼‰+ Route53
    â”œâ”€â”€ observability/  # CloudWatchç›£è¦–
    â”œâ”€â”€ security/       # Security Groups + IAM
    â””â”€â”€ storage/        # RDS + S3
```

**Stateç®¡ç†**: S3 + DynamoDBï¼ˆTerraform State Lockï¼‰

<br>

## ğŸ¤– GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

### ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆdeploy.ymlï¼‰
ãƒ¢ãƒ¼ãƒ‰é¸æŠå¯èƒ½ï¼š
- **provisioning**: åˆå›æ§‹ç¯‰ï¼ˆBlueç’°å¢ƒã®ã¿ï¼‰
- **bluegreen**: 0% â†’ 100%ï¼ˆä¸€æ‹¬åˆ‡æ›¿ï¼‰
- **canary**: 10% â†’ 100%ï¼ˆ5åˆ†é–“éš”ï¼‰

### ãƒ‡ã‚¹ãƒˆãƒ­ã‚¤ï¼ˆdestroy.ymlï¼‰
- ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§AWSãƒªã‚½ãƒ¼ã‚¹å‰Šé™¤

### é™çš„è§£æãƒ»ãƒ“ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯ï¼ˆpr-check.ymlï¼‰
**è‡ªå‹•å®Ÿè¡Œ**: ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆä½œæˆãƒ»æ›´æ–°æ™‚
- Backend: ESLint + Build
- Frontend: TypeScript + Build
- Terraform: Format + Validate

### SASTãƒ»SCAã‚¹ã‚­ãƒ£ãƒ³ï¼ˆsecurity-scan.ymlï¼‰
**è‡ªå‹•å®Ÿè¡Œ**: ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆä½œæˆãƒ»æ›´æ–°æ™‚ + æ¯é€±æœˆæ›œ0æ™‚ï¼ˆå®šæœŸã‚¹ã‚­ãƒ£ãƒ³ï¼‰
- ä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆTrivyï¼‰
- ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆTrivy + Dockerã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰
- SASTã‚¹ã‚­ãƒ£ãƒ³ï¼ˆCodeQLï¼‰
- Terraformã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆtfsecï¼‰
- ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¼æ´©æ¤œå‡ºï¼ˆGitleaksï¼‰
- çµæœã‚’GitHub Securityã«çµ±åˆ

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³è‡ªå‹•ç”Ÿæˆï¼ˆarchitecture-diagram.ymlï¼‰
- Python diagramsã§æ§‹æˆå›³ã‚’è‡ªå‹•æ›´æ–°

<br>

### ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œä¾‹ï¼ˆprovisioningãƒ¢ãƒ¼ãƒ‰ï¼‰

<div align="center">
  <img src="docs/screenshots/github-actions-demo.gif?v=20250108165536" alt="GitHub Actions Demo" width="800">
</div>

<br>

## ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£
- **IaC**: Terraform 1.12.1ï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–è¨­è¨ˆï¼‰
- **AWS**: ECS Fargate, RDS PostgreSQL, CloudFront, Route53
- **CI/CD**: GitHub Actionsï¼ˆBlue/Green + Canaryå¯¾å¿œï¼‰

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Framework**: NestJS 10.0 + TypeScript 5.8
- **API**: GraphQLï¼ˆCode Firstï¼‰
- **Database**: PostgreSQL 15

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **Framework**: React 19.0 + TypeScript 5.8
- **Build**: Vite
- **Map**: Mapbox GL JS
- **API**: Apollo Clientï¼ˆGraphQLï¼‰

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–
- **IAM**: Permission Boundary + AssumeRoleï¼ˆæœ€å°æ¨©é™ã®åŸå‰‡ã‚’å®Ÿè£…ï¼‰
- **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯**: 3å±¤VPC + Private Subnetï¼ˆDBå±¤ã¯å¤–éƒ¨éå…¬é–‹ï¼‰
- **æš—å·åŒ–**: RDSæš—å·åŒ– + Secrets Managerï¼ˆèªè¨¼æƒ…å ±ã®å®‰å…¨ç®¡ç†ï¼‰
- **ç›£æŸ»**: CloudTrail + Athenaåˆ†æï¼ˆå…¨æ“ä½œãƒ­ã‚°ã‚’90æ—¥é–“ä¿æŒãƒ»åˆ†æå¯èƒ½ï¼‰
- **è„†å¼±æ€§**: SAST/SCA é€±æ¬¡ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆTrivy + CodeQL + tfsec + Gitleaksï¼‰
- **WAF**: CloudFront + ALBå¯¾å¿œï¼ˆã‚³ã‚¹ãƒˆå‰Šæ¸›ã®ãŸã‚ç„¡åŠ¹åŒ–ä¸­ï¼‰

## ğŸ’ª æŠ€è¡“çš„ãªæŒ‘æˆ¦ã¨æˆæœ

å®Ÿå‹™ãƒ¬ãƒ™ãƒ«ã®ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰ã§ç›´é¢ã—ãŸèª²é¡Œã¨ã€ãã®è§£æ±ºã‚’é€šã˜ã¦å¾—ãŸå­¦ã³ï¼š

- **Blue/Greenãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ**: IAMæ¨©é™ã®æ®µéšçš„è¿½åŠ ã«ã‚ˆã‚Š5åˆ†ä»¥å†…ã®ç„¡åœæ­¢åˆ‡æ›¿ã‚’å®Ÿç¾
- **æœ€å°æ¨©é™è¨­è¨ˆ**: Permission Boundaryã§ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨è‡ªå‹•åŒ–ã‚’ä¸¡ç«‹
- **3å±¤VPCã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: NAT Gatewayè¨­è¨ˆã§DBå±¤ã‚’å®Œå…¨éå…¬é–‹åŒ–
- **Terraform Stateç®¡ç†**: S3 + DynamoDBã§ãƒãƒ¼ãƒ é–‹ç™ºã«å¯¾å¿œå¯èƒ½ãªåŸºç›¤æ§‹ç¯‰
- **ä¾å­˜é–¢ä¿‚ã®æœ€é©åŒ–**: ãƒªã‚½ãƒ¼ã‚¹å‰Šé™¤é †åºã®åˆ¶å¾¡ã§å®‰å…¨ãªç’°å¢ƒç ´æ£„ã‚’å®Ÿç¾

## ğŸ“‹ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰](./docs/setup/README.md) - ç’°å¢ƒæ§‹ç¯‰ãƒ»äº‹å‰æº–å‚™
- [ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰](./docs/deployment/codedeploy-blue-green.md) - Blue/Green/Canaryãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
- [é‹ç”¨ã‚¬ã‚¤ãƒ‰](./docs/operations/README.md) - IAMç®¡ç†ãƒ»ç›£è¦–ãƒ»åˆ†æ
- [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](./docs/architecture/aws/mermaid/README.md) - ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³
- [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](./docs/troubleshooting/README.md) - å®Ÿè£…æ™‚ã®èª²é¡Œã¨è§£æ±ºæ–¹æ³•

